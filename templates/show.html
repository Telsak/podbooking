{% extends 'base.html' %}
{% block content %}
{% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
        {% for category, message in messages %}
            <div class="alert alert-{{category}} alert-dismissible fade show" role="alert">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
        {% endfor %}
    {% endif %}
{% endwith %}
<span class="rubrik">Booking of {{ show['room']['name'] }}</span><br>
<span class="brodtext">
    <font color=red size=+1>RULES:
        <br>&nbsp;- Book only two slots (4 hours) in advance'
        <br>&nbsp;- PODs are free to use 20 minutes after NoShow'
    </font></span>
    <hr>
    <p style="text-align:center">
        <font color="blue" size=+2>
            <a href="/show/{{ show['room']['name'] }}/{{show['dates']['yesterday']['date']}}"><i class="bi bi-arrow-left-circle-fill"></i></a>
            <a href="/show/{{ show['room']['name'] }}"><i class="bi bi-arrow-up-circle-fill"></i></a>
            <a href="/show/{{ show['room']['name'] }}/{{show['dates']['tomorrow']['date']}}"><i class="bi bi-arrow-right-circle-fill"></i></a>
        </font>
    </p>
<div class="table-responsive">
    <table class="table">
    <tr valign="top">
        <td>
            <table class="table table-striped table-bordered" style="border-collapse:separate;border-spacing:10px;">
                <tr>
                    <th class="table-primary">Time</th>
                    {% for pod in show['room']['pods'] %}
                    <th class="table-primary">Pod {{ pod }}</th>
                    {% endfor %}
                </tr>
                <tr>
                {% for hour in show['clocks'] %}
                    <td class="table-primary">{{ hour }}-{{ hour+2 }}</td>
                    {% for pod in show['query'][hour] %}
                        {% if show['flag'] == 'STANDARD' %}
                            {{ show['query'][hour][pod]|safe }}
                        {% elif show['flag'] == 'DAYBOOKING' and current_user.is_authenticated %}
                            {% if current_user.role.name in ['Admin', 'Teacher'] %}
                                {{ show['query'][hour][pod]|safe }}
                            {% else %}
                                <td class="table-danger">Reserved by Teachers</td>
                            {% endif %}
                        {% else %}
                            <td class="table-danger">Reserved by Teachers</td>
                        {% endif %}
                    {% endfor %}
                </tr>
                {% endfor %}              
            </table>
        </td>
    </tr>
    </table>    
</div>

<div class="modal fade" id="userInfo" tabindex="-1" aria-labelledby="userInfoLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="userInfoLabel">User Information for </h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          This is some information about
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <!--
          <button type="submit" class="btn btn-danger">DELETE USER</button>
        -->
        </div>
      </div>
    </div>
  </div>

<script>
    var exampleModal = document.getElementById('userInfo')
    exampleModal.addEventListener('show.bs.modal', function (event) {
        // Button that triggered the modal
        var button = event.relatedTarget
        // Extract info from data-bs-* attributes
        var username = button.getAttribute('data-bs-username')
        // Update the modal's content.
        var modalTitle = exampleModal.querySelector('.modal-title')
        var modalBodyInput = exampleModal.querySelector('.modal-body')

        modalTitle.textContent += username
        modalBodyInput.textContent = 'This is set by the modal script'
        }
    )

</script>

{% endblock %}